<body id="categoriesBody">

  <style>
    .thumb #wallpaper {
      width: 416px;
      height: 416px;
      object-fit: cover;
    }
  </style>

  <div class="page-heading">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2 header-text">
          <h2>Discover Most Popular Categories on <em>SnapOff</em></h2>
          <p>Explore our diverse contest categories, spanning landscapes, portraits, wildlife, and more. Submit your
            best photos, compete, and let your creativity shine at SnapOff.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="search-form" style="margin-bottom: 180px;">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <form id="search-form" name="gs" method="submit" role="search" action="#">
            <div class="row">
              <div class="col-lg-4">
                <fieldset>
                  <label for="contest" class="form-label">Search Any Contest</label>
                  <input type="text" name="contest" class="searchText" placeholder="Contest Name..." autocomplete="on">
                </fieldset>
              </div>
              <div class="col-lg-4">
                <fieldset>
                  <label for="category" class="form-label">Pick Category</label>
                  <select name="category" class="form-select" aria-label="Choose a category" id="category"
                    onchange="this.form.click()">
                    <option selected>Choose a category</option>
                    <option type="checkbox" name="nature" value="nature">Nature Photography</option>
                    <option value="portrait">Portrait Photography</option>
                    <option value="random">Random Photography</option>
                  </select>
                </fieldset>
              </div>
              <div class="col-lg-2">
                <fieldset>
                  <label for="chooseprice" class="form-label">Entry Price</label>
                  <select name="Price" class="form-select" aria-label="Default select example" id="chooseCategory"
                    onchange="this.form.click()">
                    <option selected>Choose a price</option>
                    <option value="0">Free</option>
                    <option value="10">€10 to €20</option>
                    <option value="25">€25 to €50</option>
                    <option value="50+">€50+</option>
                  </select>
                </fieldset>
              </div>
              <div class="col-lg-2">
                <fieldset>
                  <button class="main-button">Search Now</button>
                </fieldset>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <section class="featured-contests mb-3">
    <div class="container">
      <div id="search-row" class="row">

      </div>
    </div>
  </section>

  <script>
    let row = document.getElementById('search-row');

    fetch('../assets/json/contests.json')
      .then(response => response.json())
      .then(data => {
        data.contests.forEach(contest => {

          let price;
          if (contest.entry_price == 0) {
            price = 'Free';
          } else {
            price = `€${contest.entry_price}`;
          }
          row.innerHTML += `
          <div class="col-lg-4">
          <div class="item">
            <div class="thumb">
                <img id="wallpaper" src=${contest.image_source} alt="" width="416" height="416">
              <div class="hover-effect">
                <div class="content">
                  <div class="top-content">
                    <span class="award">Entry Price</span>
                    <span class="price">€${contest.entry_price}</span>
                  </div>
                  <h4>${contest.name}</h4>
                  <div class="info">
                    <span class="participants"><img src="assets//images/icon-03.png"
                        alt=""><br>${contest.participants}<br>Participants</span>
                    <span class="submittions"><img src="assets//images/icon-01.png" alt=""><br>${contest.submissions}<br>Submissions</span>
                  </div>
                  <div class="border-button">
                    <a href="#contest-details" onclick="setContestId(${contest.id})">Open Contest Page</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>`
        });

        let form = document.getElementById('search-form');
        let categorySelect = document.getElementById('category');
        let nameInput = document.querySelector('input[name="contest"]');

        form.addEventListener('submit', function (event) {
          console.log('Form submitted!')
          event.preventDefault();


          row.innerHTML = '';

          let filteredContests;


          if (nameInput.value && categorySelect.value !== 'Choose a category') {

            filteredContests = data.contests.filter(contest => contest.name.toLowerCase().includes(nameInput.value.toLowerCase()) && contest.category === categorySelect.value);
          } else if (nameInput.value) {

            filteredContests = data.contests.filter(contest => contest.name.toLowerCase().includes(nameInput.value.toLowerCase()));
          } else if (categorySelect.value !== 'Choose a category') {

            filteredContests = data.contests.filter(contest => contest.category === categorySelect.value);
          } else {

            filteredContests = data.contests;
          }


          filteredContests.forEach(contest => {
            let price;
            if (contest.entry_price == 0) {
              price = 'Free';
            } else {
              price = `€${contest.entry_price}`;
            }
            row.innerHTML += `
        <div class="col-lg-4">
        <div class="item">
          <div class="thumb">
              <img src=${contest.image_source} alt="" width="416" height="416">
            <div class="hover-effect">
              <div class="content">
                <div class="top-content">
                  <span class="award">Entry Price</span>
                  <span class="price">€${contest.entry_price}</span>
                </div>
                <h4>${contest.name}</h4>
                <div class="info">
                  <span class="participants"><img src="assets//images/icon-03.png"
                      alt=""><br>${contest.participants}<br>Participants</span>
                  <span class="submittions"><img src="assets//images/icon-01.png" alt=""><br>${contest.submissions}<br>Submissions</span>
                </div>
                <div class="border-button">
                  <a href="#contest-details" onclick="setContestId(${contest.id})"">Open Contest Page</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>`
          });
        });


      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });
  </script>

</body>

</html>